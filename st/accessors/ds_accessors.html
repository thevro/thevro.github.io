<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Dataset accessor methods &#8212; shnitsel-tools 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DataArray accessor methods" href="da_accessors.html" />
    <link rel="prev" title="Top-level functions" href="../top-level.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dataset-accessor-methods">
<h1>Dataset accessor methods<a class="headerlink" href="#dataset-accessor-methods" title="Link to this heading">¶</a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.assign_fosc">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">assign_fosc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.assign_fosc" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ds</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.xrhelpers.assign_levels">
<span class="sig-prename descclassname"><span class="pre">xrhelpers.</span></span><span class="sig-name descname"><span class="pre">assign_levels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">levels_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.xrhelpers.assign_levels" title="Link to this definition">¶</a></dt>
<dd><p>Assign new values to levels of MultiIndexes in <code class="docutils literal notranslate"><span class="pre">obj</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) – An <code class="docutils literal notranslate"><span class="pre">xarray</span></code> object with at least one MultiIndex</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Buffer" title="(in Python v3.13)"><em>Buffer</em></a><em> | </em><em>_SupportsArray</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em><em>] </em><em>| </em><em>_NestedSequence</em><em>[</em><em>_SupportsArray</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><em>complex</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><em>bytes</em></a><em> | </em><em>_NestedSequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><em>complex</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><em>bytes</em></a><em>]</em><em>] </em><em>| </em><em>None</em>) – A mapping whose keys are the names of the levels and whose values are the
levels to assign. The mapping will be passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">xr.DataArray.assign_coords()</span></code>
(or the <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.Dataset</span></code> equivalent).</p></li>
<li><p><strong>optional</strong> – A mapping whose keys are the names of the levels and whose values are the
levels to assign. The mapping will be passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">xr.DataArray.assign_coords()</span></code>
(or the <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.Dataset</span></code> equivalent).</p></li>
<li><p><strong>levels_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Buffer" title="(in Python v3.13)"><em>Buffer</em></a><em> | </em><em>_SupportsArray</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em><em>] </em><em>| </em><em>_NestedSequence</em><em>[</em><em>_SupportsArray</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><em>dtype</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><em>complex</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><em>bytes</em></a><em> | </em><em>_NestedSequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><em>complex</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><em>bytes</em></a><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A new object with the new level values replacing the old level values.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If levels are provided in both keyword and dictionary form.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.broaden_gauss">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">broaden_gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fosc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'frame'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.broaden_gauss" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) – values used for the x-axis, presumably $E_i$</p></li>
<li><p><strong>fosc</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) – values used for the y-axis, presumably $f_mathrm{osc}$</p></li>
<li><p><strong>agg_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Hashable" title="(in Python v3.13)"><em>Hashable</em></a>) – dimension along which to aggregate the many Gaussian distributions,
by default ‘frame’</p></li>
<li><p><strong>optional</strong> – dimension along which to aggregate the many Gaussian distributions,
by default ‘frame’</p></li>
<li><p><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – the width (i.e. 2 standard deviations) of the Gaussian distributions
used, by default 0.001</p></li>
<li><p><strong>optional</strong> – the width (i.e. 2 standard deviations) of the Gaussian distributions
used, by default 0.001</p></li>
<li><p><strong>nsamples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of evenly spaced x-values over which to sample the distribution,
by default 1000</p></li>
<li><p><strong>optional</strong> – number of evenly spaced x-values over which to sample the distribution,
by default 1000</p></li>
<li><p><strong>xmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>) – the maximum x-value, by default 3 standard deviations
beyond the pre-broadened maximum</p></li>
<li><p><strong>optional</strong> – the maximum x-value, by default 3 standard deviations
beyond the pre-broadened maximum</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.calc_pops">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">calc_pops</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.calc_pops" title="Link to this definition">¶</a></dt>
<dd><p>Fast way to calculate populations
Requires states ids to be small integers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.default_mol">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">default_mol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.default_mol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.filtre.energy_filtranda">
<span class="sig-prename descclassname"><span class="pre">filtre.</span></span><span class="sig-name descname"><span class="pre">energy_filtranda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.filtre.energy_filtranda" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.xrhelpers.expand_midx">
<span class="sig-prename descclassname"><span class="pre">xrhelpers.</span></span><span class="sig-name descname"><span class="pre">expand_midx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">midx_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.xrhelpers.expand_midx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.find_hops">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">find_hops</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.find_hops" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.xrhelpers.flatten_levels">
<span class="sig-prename descclassname"><span class="pre">xrhelpers.</span></span><span class="sig-name descname"><span class="pre">flatten_levels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">renamer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.xrhelpers.flatten_levels" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>)</p></li>
<li><p><strong>idx_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>new_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>position</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>renamer</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a> | <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.filtre.get_cutoffs">
<span class="sig-prename descclassname"><span class="pre">filtre.</span></span><span class="sig-name descname"><span class="pre">get_cutoffs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.filtre.get_cutoffs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.get_inter_state">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">get_inter_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.get_inter_state" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.get_per_state">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">get_per_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.get_per_state" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.parse.sharc_icond.iconds_to_frames">
<span class="sig-prename descclassname"><span class="pre">sharc_icond.</span></span><span class="sig-name descname"><span class="pre">iconds_to_frames</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.parse.sharc_icond.iconds_to_frames" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>iconds</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.xrhelpers.mgroupby">
<span class="sig-prename descclassname"><span class="pre">xrhelpers.</span></span><span class="sig-name descname"><span class="pre">mgroupby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">levels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.xrhelpers.mgroupby" title="Link to this definition">¶</a></dt>
<dd><p>Group a Dataset or DataArray by several levels of a MultiIndex it contains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) – The <code class="xref py py-mod docutils literal notranslate"><span class="pre">xr</span></code> object to group</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – Names of MultiIndex levels all belonging to the <em>same</em> MultiIndex</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>The grouped object, which behaves as documented at <code class="xref py py-meth docutils literal notranslate"><span class="pre">xr.Dataset.groupby()</span></code></p></li>
<li><p>and <cite>xr.DataArray.groupby</cite> with the caveat that the specified levels have been</p></li>
<li><p><em>”flattened” into a single Multiindex level of tuples.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If no MultiIndex is found, or if the named levels belong to different MultiIndexes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.core.groupby.DataArrayGroupBy.html#xarray.core.groupby.DataArrayGroupBy" title="(in xarray v2025.7.2)"><em>DataArrayGroupBy</em></a> | <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.core.groupby.DatasetGroupBy.html#xarray.core.groupby.DatasetGroupBy" title="(in xarray v2025.7.2)"><em>DatasetGroupBy</em></a></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The function does not currently check whether the levels specified are really levels
of a MultiIndex, as opposed to names of non-MultiIndex indexes.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.xrhelpers.msel">
<span class="sig-prename descclassname"><span class="pre">xrhelpers.</span></span><span class="sig-name descname"><span class="pre">msel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.xrhelpers.msel" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.pca_and_hops">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">pca_and_hops</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.pca_and_hops" title="Link to this definition">¶</a></dt>
<dd><p>Get PCA points and info on which of them represent hops</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>) – A Dataset containing ‘atXYZ’ and ‘astate’ variables</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pca_res</em> – The PCA-reduced pairwise interatomic distances</p></li>
<li><p><em>hops_pca_coords</em> – <cite>pca_res</cite> filtered by hops, to facilitate marking hops when plotting</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>, <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.xrhelpers.save_frames">
<span class="sig-prename descclassname"><span class="pre">xrhelpers.</span></span><span class="sig-name descname"><span class="pre">save_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.xrhelpers.save_frames" title="Link to this definition">¶</a></dt>
<dd><p>Save a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, presumably (but not necessarily) consisting of frames of trajectories, to a file at <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accessor</strong><strong>)</strong> (<em>frames</em><em> (</em><em>omit if using</em>) – The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> to save</p></li>
<li><p><strong>path</strong> – The path at which to save it</p></li>
<li><p><strong>complevel</strong> – The level of <code class="docutils literal notranslate"><span class="pre">gzip</span></code> compression which will be applied to all variables in the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, by default 9</p></li>
<li><p><strong>optional</strong> – The level of <code class="docutils literal notranslate"><span class="pre">gzip</span></code> compression which will be applied to all variables in the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, by default 9</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function/accessor method wraps <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.to_netcdf.html#xarray.Dataset.to_netcdf" title="(in xarray v2025.7.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">xarray.Dataset.to_netcdf()</span></code></a> but not <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.any.html#numpy.any" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.any()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.xrhelpers.sel_trajs">
<span class="sig-prename descclassname"><span class="pre">xrhelpers.</span></span><span class="sig-name descname"><span class="pre">sel_trajs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajids_or_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.xrhelpers.sel_trajs" title="Link to this definition">¶</a></dt>
<dd><p>Select trajectories using a list of trajectories IDs or a boolean mask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>) – The <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.Dataset</span></code> from which a selection is to be drawn</p></li>
<li><p><strong>trajids_or_mask</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>) – <dl class="simple">
<dt>Either</dt><dd><ul>
<li><p>A sequences of integers representing trajectory IDs to be included, in which
case the trajectories <strong>may not be returned in the order specified</strong>.</p></li>
<li><p>Or a sequence of booleans, each indicating whether the trajectory with an ID
in the corresponding entry in the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>’s <code class="docutils literal notranslate"><span class="pre">trajid_</span></code> coordinate
should be included</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>invert</strong> – Whether to invert the selection, i.e. return those trajectories not specified, by default False</p></li>
<li><p><strong>optional</strong> – Whether to invert the selection, i.e. return those trajectories not specified, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.Dataset</span></code> containing only the specified trajectories</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – when an attempt is made to index an <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.Datset</span></code> without a
    <code class="docutils literal notranslate"><span class="pre">trajid_</span></code> dimension/coordinate using a boolean mask</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">trajids_or_mask</span></code> has a dtype other than integer or boolean</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.setup_frames">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">setup_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_to_eV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_e_kin_to_eV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativize_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativize_selector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.setup_frames" title="Link to this definition">¶</a></dt>
<dd><p>Performs several frequent setup tasks.
Each task can be skipped (by setting the corresponding parameter to False),
carried out if appropriate (None), or forced in the sense that an error is
thrown if the task is redundant (True).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>) – The frames-like xr.Dataset to setup.</p></li>
<li><p><strong>to_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) – Whether to convert a ‘ts’ (timestep) coordinate to a ‘time’ coordinate, by default None</p></li>
<li><p><strong>optional</strong> – Whether to convert a ‘ts’ (timestep) coordinate to a ‘time’ coordinate, by default None</p></li>
<li><p><strong>convert_to_eV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) – Whether to convert the ‘energy’ variable to eV, by default None</p></li>
<li><p><strong>optional</strong> – Whether to convert the ‘energy’ variable to eV, by default None</p></li>
<li><p><strong>convert_e_kin_to_eV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) – Whether to convert the ‘e_kin’ (kinetic energy) variable to eV, by default None</p></li>
<li><p><strong>optional</strong> – Whether to convert the ‘e_kin’ (kinetic energy) variable to eV, by default None</p></li>
<li><p><strong>relativize_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) – Whether to relativize energies, by default None</p></li>
<li><p><strong>optional</strong> – Whether to relativize energies, by default None</p></li>
<li><p><strong>relativize_selector</strong> – This argument is passed to relativize, by default None</p></li>
<li><p><strong>optional</strong> – This argument is passed to relativize, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A modified frames-like xr.Dataset</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If a task should be forced (i.e. the corresponding parameter is set to True)
    but cannot be carried out (e.g. because the dataset was already processed previously)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.plot.spectra3d.spectra_all_times">
<span class="sig-prename descclassname"><span class="pre">spectra3d.</span></span><span class="sig-name descname"><span class="pre">spectra_all_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.plot.spectra3d.spectra_all_times" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inter_state</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.filtre.truncate">
<span class="sig-prename descclassname"><span class="pre">filtre.</span></span><span class="sig-name descname"><span class="pre">truncate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoffs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.filtre.truncate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.ts_to_time">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">ts_to_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'drop'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.ts_to_time" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a><em> | </em><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>)</p></li>
<li><p><strong>delta_t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>old</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'drop'</em><em>, </em><em>'to_var'</em><em>, </em><em>'keep'</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.validate">
<span class="sig-prename descclassname"><span class="pre">postprocess.</span></span><span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.validate" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.core.ase.write_ase">
<span class="sig-prename descclassname"><span class="pre">ase.</span></span><span class="sig-name descname"><span class="pre">write_ase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.ase.write_ase" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p></li>
<li><p><strong>db_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Collection" title="(in Python v3.13)"><em>Collection</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>preprocess</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">shnitsel-tools</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../top-level.html">Top-level functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dataset accessor methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.assign_fosc"><code class="docutils literal notranslate"><span class="pre">postprocess.assign_fosc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.xrhelpers.assign_levels"><code class="docutils literal notranslate"><span class="pre">xrhelpers.assign_levels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.broaden_gauss"><code class="docutils literal notranslate"><span class="pre">postprocess.broaden_gauss()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.calc_pops"><code class="docutils literal notranslate"><span class="pre">postprocess.calc_pops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.default_mol"><code class="docutils literal notranslate"><span class="pre">postprocess.default_mol()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.filtre.energy_filtranda"><code class="docutils literal notranslate"><span class="pre">filtre.energy_filtranda()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.xrhelpers.expand_midx"><code class="docutils literal notranslate"><span class="pre">xrhelpers.expand_midx()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.find_hops"><code class="docutils literal notranslate"><span class="pre">postprocess.find_hops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.xrhelpers.flatten_levels"><code class="docutils literal notranslate"><span class="pre">xrhelpers.flatten_levels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.filtre.get_cutoffs"><code class="docutils literal notranslate"><span class="pre">filtre.get_cutoffs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.get_inter_state"><code class="docutils literal notranslate"><span class="pre">postprocess.get_inter_state()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.get_per_state"><code class="docutils literal notranslate"><span class="pre">postprocess.get_per_state()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.parse.sharc_icond.iconds_to_frames"><code class="docutils literal notranslate"><span class="pre">sharc_icond.iconds_to_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.xrhelpers.mgroupby"><code class="docutils literal notranslate"><span class="pre">xrhelpers.mgroupby()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.xrhelpers.msel"><code class="docutils literal notranslate"><span class="pre">xrhelpers.msel()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.pca_and_hops"><code class="docutils literal notranslate"><span class="pre">postprocess.pca_and_hops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.xrhelpers.save_frames"><code class="docutils literal notranslate"><span class="pre">xrhelpers.save_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.xrhelpers.sel_trajs"><code class="docutils literal notranslate"><span class="pre">xrhelpers.sel_trajs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.setup_frames"><code class="docutils literal notranslate"><span class="pre">postprocess.setup_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.plot.spectra3d.spectra_all_times"><code class="docutils literal notranslate"><span class="pre">spectra3d.spectra_all_times()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.filtre.truncate"><code class="docutils literal notranslate"><span class="pre">filtre.truncate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.ts_to_time"><code class="docutils literal notranslate"><span class="pre">postprocess.ts_to_time()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.postprocess.validate"><code class="docutils literal notranslate"><span class="pre">postprocess.validate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#shnitsel.core.ase.write_ase"><code class="docutils literal notranslate"><span class="pre">ase.write_ase()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="da_accessors.html">DataArray accessor methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../test-autosummary-accessors.html">Test autosummary-accessors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../priority.html">Functions to document first</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../top-level.html" title="previous chapter">Top-level functions</a></li>
      <li>Next: <a href="da_accessors.html" title="next chapter">DataArray accessor methods</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Theodor Everley Röhrkasten, Carolin Müller.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/accessors/ds_accessors.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>