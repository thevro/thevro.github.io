<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shnitsel-tools documentation &#8212; shnitsel-tools 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Top-level functions" href="top-level.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="shnitsel-tools-documentation">
<h1>shnitsel-tools documentation<a class="headerlink" href="#shnitsel-tools-documentation" title="Link to this heading">Â¶</a></h1>
<p>Add your content using <code class="docutils literal notranslate"><span class="pre">reStructuredText</span></code> syntax. See the
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/index.html">reStructuredText</a>
documentation for details.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="top-level.html">Top-level functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="top-level.html#shnitsel.open_frames"><code class="docutils literal notranslate"><span class="pre">open_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="top-level.html#shnitsel.read_ase"><code class="docutils literal notranslate"><span class="pre">read_ase()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="top-level.html#shnitsel.read_trajs"><code class="docutils literal notranslate"><span class="pre">read_trajs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="accessors/ds_accessors.html">Dataset accessor methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.assign_fosc"><code class="docutils literal notranslate"><span class="pre">postprocess.assign_fosc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.xrhelpers.assign_levels"><code class="docutils literal notranslate"><span class="pre">xrhelpers.assign_levels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.broaden_gauss"><code class="docutils literal notranslate"><span class="pre">postprocess.broaden_gauss()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.calc_pops"><code class="docutils literal notranslate"><span class="pre">postprocess.calc_pops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.default_mol"><code class="docutils literal notranslate"><span class="pre">postprocess.default_mol()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.filtre.energy_filtranda"><code class="docutils literal notranslate"><span class="pre">filtre.energy_filtranda()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.xrhelpers.expand_midx"><code class="docutils literal notranslate"><span class="pre">xrhelpers.expand_midx()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.find_hops"><code class="docutils literal notranslate"><span class="pre">postprocess.find_hops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.xrhelpers.flatten_levels"><code class="docutils literal notranslate"><span class="pre">xrhelpers.flatten_levels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.filtre.get_cutoffs"><code class="docutils literal notranslate"><span class="pre">filtre.get_cutoffs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.get_inter_state"><code class="docutils literal notranslate"><span class="pre">postprocess.get_inter_state()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.get_per_state"><code class="docutils literal notranslate"><span class="pre">postprocess.get_per_state()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.parse.sharc_icond.iconds_to_frames"><code class="docutils literal notranslate"><span class="pre">sharc_icond.iconds_to_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.xrhelpers.mgroupby"><code class="docutils literal notranslate"><span class="pre">xrhelpers.mgroupby()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.xrhelpers.msel"><code class="docutils literal notranslate"><span class="pre">xrhelpers.msel()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.pca_and_hops"><code class="docutils literal notranslate"><span class="pre">postprocess.pca_and_hops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.xrhelpers.save_frames"><code class="docutils literal notranslate"><span class="pre">xrhelpers.save_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.xrhelpers.sel_trajs"><code class="docutils literal notranslate"><span class="pre">xrhelpers.sel_trajs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.setup_frames"><code class="docutils literal notranslate"><span class="pre">postprocess.setup_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.plot.spectra3d.spectra_all_times"><code class="docutils literal notranslate"><span class="pre">spectra3d.spectra_all_times()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.filtre.truncate"><code class="docutils literal notranslate"><span class="pre">filtre.truncate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.ts_to_time"><code class="docutils literal notranslate"><span class="pre">postprocess.ts_to_time()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.postprocess.validate"><code class="docutils literal notranslate"><span class="pre">postprocess.validate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/ds_accessors.html#shnitsel.core.ase.write_ase"><code class="docutils literal notranslate"><span class="pre">ase.write_ase()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="accessors/da_accessors.html">DataArray accessor methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.angle"><code class="docutils literal notranslate"><span class="pre">postprocess.angle()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.xrhelpers.assign_levels"><code class="docutils literal notranslate"><span class="pre">xrhelpers.assign_levels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.calc_ci"><code class="docutils literal notranslate"><span class="pre">postprocess.calc_ci()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.default_mol"><code class="docutils literal notranslate"><span class="pre">postprocess.default_mol()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.dihedral"><code class="docutils literal notranslate"><span class="pre">postprocess.dihedral()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.distance"><code class="docutils literal notranslate"><span class="pre">postprocess.distance()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.xrhelpers.expand_midx"><code class="docutils literal notranslate"><span class="pre">xrhelpers.expand_midx()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.xrhelpers.flatten_levels"><code class="docutils literal notranslate"><span class="pre">xrhelpers.flatten_levels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.filtre.get_bond_lengths"><code class="docutils literal notranslate"><span class="pre">filtre.get_bond_lengths()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.get_hop_types"><code class="docutils literal notranslate"><span class="pre">postprocess.get_hop_types()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.hop_indices"><code class="docutils literal notranslate"><span class="pre">postprocess.hop_indices()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.keep_norming"><code class="docutils literal notranslate"><span class="pre">postprocess.keep_norming()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.filtre.last_time_where"><code class="docutils literal notranslate"><span class="pre">filtre.last_time_where()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.xrhelpers.mgroupby"><code class="docutils literal notranslate"><span class="pre">xrhelpers.mgroupby()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.xrhelpers.msel"><code class="docutils literal notranslate"><span class="pre">xrhelpers.msel()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.norm"><code class="docutils literal notranslate"><span class="pre">postprocess.norm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.pairwise_dists_pca"><code class="docutils literal notranslate"><span class="pre">postprocess.pairwise_dists_pca()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.pca"><code class="docutils literal notranslate"><span class="pre">postprocess.pca()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.relativize"><code class="docutils literal notranslate"><span class="pre">postprocess.relativize()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.xrhelpers.sel_trajs"><code class="docutils literal notranslate"><span class="pre">xrhelpers.sel_trajs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.subtract_combinations"><code class="docutils literal notranslate"><span class="pre">postprocess.subtract_combinations()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.sudi"><code class="docutils literal notranslate"><span class="pre">postprocess.sudi()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.time_grouped_ci"><code class="docutils literal notranslate"><span class="pre">postprocess.time_grouped_ci()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.to_mol"><code class="docutils literal notranslate"><span class="pre">postprocess.to_mol()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.to_xyz"><code class="docutils literal notranslate"><span class="pre">postprocess.to_xyz()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.traj_to_xyz"><code class="docutils literal notranslate"><span class="pre">postprocess.traj_to_xyz()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.trajs_with_hops"><code class="docutils literal notranslate"><span class="pre">postprocess.trajs_with_hops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="accessors/da_accessors.html#shnitsel.core.postprocess.ts_to_time"><code class="docutils literal notranslate"><span class="pre">postprocess.ts_to_time()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="test-autosummary-accessors.html">Test autosummary-accessors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="_generated/xarray.DataArray.test.sudi.html">xarray.DataArray.test.sudi</a></li>
<li class="toctree-l2"><a class="reference internal" href="_generated/xarray.DataArray.test.subtract_combinations.html">xarray.DataArray.test.subtract_combinations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="priority.html">Functions to document first</a><ul>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.parse.sharc_icond.dirs_of_iconds"><code class="docutils literal notranslate"><span class="pre">dirs_of_iconds()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.parse.read_trajs"><code class="docutils literal notranslate"><span class="pre">read_trajs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.open_frames"><code class="docutils literal notranslate"><span class="pre">open_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.filtre.get_bond_lengths"><code class="docutils literal notranslate"><span class="pre">filtre.get_bond_lengths()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.xrhelpers.msel"><code class="docutils literal notranslate"><span class="pre">xrhelpers.msel()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.xrhelpers.sel_trajs"><code class="docutils literal notranslate"><span class="pre">xrhelpers.sel_trajs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.xrhelpers.save_frames"><code class="docutils literal notranslate"><span class="pre">xrhelpers.save_frames()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.dihedral"><code class="docutils literal notranslate"><span class="pre">postprocess.dihedral()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.get_inter_state"><code class="docutils literal notranslate"><span class="pre">postprocess.get_inter_state()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.plot.spectra3d.spectra_all_times"><code class="docutils literal notranslate"><span class="pre">spectra3d.spectra_all_times()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.plot.biplot_kde"><code class="docutils literal notranslate"><span class="pre">biplot_kde()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.plot.ski_plots"><code class="docutils literal notranslate"><span class="pre">ski_plots()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.ase.write_ase"><code class="docutils literal notranslate"><span class="pre">ase.write_ase()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.relativize"><code class="docutils literal notranslate"><span class="pre">postprocess.relativize()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.filtre.energy_filtranda"><code class="docutils literal notranslate"><span class="pre">filtre.energy_filtranda()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.filtre.get_cutoffs"><code class="docutils literal notranslate"><span class="pre">filtre.get_cutoffs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.filtre.truncate"><code class="docutils literal notranslate"><span class="pre">filtre.truncate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.distance"><code class="docutils literal notranslate"><span class="pre">postprocess.distance()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.assign_fosc"><code class="docutils literal notranslate"><span class="pre">postprocess.assign_fosc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.plot.Datasheet.plot_separated_spectra_and_hists"><code class="docutils literal notranslate"><span class="pre">Datasheet.plot_separated_spectra_and_hists()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#id0"><code class="docutils literal notranslate"><span class="pre">plot.ski_plots()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.calc_pops"><code class="docutils literal notranslate"><span class="pre">postprocess.calc_pops()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#id1"><code class="docutils literal notranslate"><span class="pre">xrhelpers.msel()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.filtre.last_time_where"><code class="docutils literal notranslate"><span class="pre">filtre.last_time_where()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.subtract_combinations"><code class="docutils literal notranslate"><span class="pre">postprocess.subtract_combinations()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.to_mol"><code class="docutils literal notranslate"><span class="pre">postprocess.to_mol()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#id4"><code class="docutils literal notranslate"><span class="pre">postprocess.subtract_combinations()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.norm"><code class="docutils literal notranslate"><span class="pre">postprocess.norm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.pca"><code class="docutils literal notranslate"><span class="pre">postprocess.pca()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.postprocess.pairwise_dists_pca"><code class="docutils literal notranslate"><span class="pre">postprocess.pairwise_dists_pca()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="priority.html#shnitsel.core.xrhelpers.mgroupby"><code class="docutils literal notranslate"><span class="pre">xrhelpers.mgroupby()</span></code></a></li>
</ul>
</li>
</ul>
</div>
<section id="testing">
<h2>testing<a class="headerlink" href="#testing" title="Link to this heading">Â¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.plot.biplot_kde">
<span class="sig-prename descclassname"><span class="pre">plot.</span></span><span class="sig-name descname"><span class="pre">biplot_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">at1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.plot.biplot_kde" title="Link to this definition">Â¶</a></dt>
<dd><p>Generates a biplot that visualizes PCA projections and kernel density estimates (KDE)
of a property (distance, angle, dihedral angle) describing the geometry of specified
atoms. The property is chosen based on the number of atoms specified:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 atoms =&gt; distance</p></li>
<li><p>3 atoms =&gt; angle</p></li>
<li><p>4 atoms =&gt; dihedral angle</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> â A dataset containing trajectory frames with atomic coordinates.</p></li>
<li><p><strong>at1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â Indices of the first, second, third and fourth atoms for geometric property calculation.</p></li>
<li><p><strong>at2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â Indices of the first, second, third and fourth atoms for geometric property calculation.</p></li>
<li><p><strong>at3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) â Indices of the first, second, third and fourth atoms for geometric property calculation.</p></li>
<li><p><strong>at4</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) â Indices of the first, second, third and fourth atoms for geometric property calculation.</p></li>
<li><p><strong>geo_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em><em>] </em><em>| </em><em>None</em>) â A list of tuples representing ranges. A KDE is plotted for each range, indicating the distribution of
points for which the value of the geometry feature falls in that range.</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>] </em><em>| </em><em>None</em>) â Contour levels for the KDE plot. Defaults to [0.08, 1]. This parameter is passed to
matplotlib.axes.Axes.contour.</p></li>
<li><p><strong>scatter_color</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'time'</em><em>, </em><em>'geo'</em><em>]</em>) â Must be one of âtimeâ or âgeoâ. If âtimeâ, the scatter-points will be colored based on the time coordinate;
if âgeoâ, the scatter-points will be colored based on the relevant geometry feature (see above).</p></li>
<li><p><strong>fill</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â Whether to plot filled contours (<code class="docutils literal notranslate"><span class="pre">fill=True</span></code>, uses <code class="docutils literal notranslate"><span class="pre">ax.contourf</span></code>)
or just contour lines (<code class="docutils literal notranslate"><span class="pre">fill=False</span></code>, uses <code class="docutils literal notranslate"><span class="pre">ax.contour</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed KDE data for the atom-atom distance distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>kde_dat</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Computes a geometric property of the specified atoms across all frames.</p></li>
<li><p>Uses kernel density estimation (KDE) to analyze the distance distributions.</p></li>
<li><p>Performs PCA on trajectory pairwise distances and visualizes clustering of structural changes.</p></li>
<li><p>Produces a figure with PCA projection, cluster analysis, and KDE plots.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-shnitsel.core.postprocess">
<span id="postprocess"></span><span id="module-shnitsel.core.datasheet"></span><h2>postprocess<a class="headerlink" href="#module-shnitsel.core.postprocess" title="Link to this heading">Â¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.broaden_gauss">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">broaden_gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fosc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'frame'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.broaden_gauss" title="Link to this definition">Â¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â values used for the x-axis, presumably $E_i$</p></li>
<li><p><strong>fosc</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â values used for the y-axis, presumably $f_mathrm{osc}$</p></li>
<li><p><strong>agg_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Hashable" title="(in Python v3.13)"><em>Hashable</em></a>) â dimension along which to aggregate the many Gaussian distributions,
by default âframeâ</p></li>
<li><p><strong>optional</strong> â dimension along which to aggregate the many Gaussian distributions,
by default âframeâ</p></li>
<li><p><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) â the width (i.e. 2 standard deviations) of the Gaussian distributions
used, by default 0.001</p></li>
<li><p><strong>optional</strong> â the width (i.e. 2 standard deviations) of the Gaussian distributions
used, by default 0.001</p></li>
<li><p><strong>nsamples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â number of evenly spaced x-values over which to sample the distribution,
by default 1000</p></li>
<li><p><strong>optional</strong> â number of evenly spaced x-values over which to sample the distribution,
by default 1000</p></li>
<li><p><strong>xmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>) â the maximum x-value, by default 3 standard deviations
beyond the pre-broadened maximum</p></li>
<li><p><strong>optional</strong> â the maximum x-value, by default 3 standard deviations
beyond the pre-broadened maximum</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.calc_pops">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">calc_pops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.calc_pops" title="Link to this definition">Â¶</a></dt>
<dd><p>Fast way to calculate populations
Requires states ids to be small integers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.dihedral">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.dihedral" title="Link to this definition">Â¶</a></dt>
<dd><p>Calculate all dihedral angles between the atoms specified.
The atoms specified needed be bonded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â A <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> of coordinates, with <code class="docutils literal notranslate"><span class="pre">atom</span></code> and <code class="docutils literal notranslate"><span class="pre">direction</span></code> dimensions</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â The four atom indices</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â The four atom indices</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â The four atom indices</p></li>
<li><p><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â The four atom indices</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â Whether to return angles in degrees (True) or radians (False), by default False</p></li>
<li><p><strong>full</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â Whether to return signed angles between -180Â° and 180Â° (True) or unsigned angles between 0 and 180Â° (False), by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> containing dihedral angles</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.get_hop_types">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">get_hop_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">astates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.get_hop_types" title="Link to this definition">Â¶</a></dt>
<dd><p>Example usage:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>astates</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.hop_indices">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">hop_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">astates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.hop_indices" title="Link to this definition">Â¶</a></dt>
<dd><p>Find in which frames the active state changes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>astates</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â A DataArray of state indicators</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A boolean DataArray indicating whether a hop took place</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.norm">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'direction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.norm" title="Link to this definition">Â¶</a></dt>
<dd><p>Calculate the 2-norm of a DataArray, reducing the dimension with dame <cite>dim</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â Array to calculate the norm of</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Hashable" title="(in Python v3.13)"><em>Hashable</em></a>) â Dimension to calculate norm along (and therby reduce), by default âdirectionâ</p></li>
<li><p><strong>optional</strong> â Dimension to calculate norm along (and therby reduce), by default âdirectionâ</p></li>
<li><p><strong>keep_attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) â How to deal with attributes; passed to xr.apply_ufunc, by default None</p></li>
<li><p><strong>optional</strong> â How to deal with attributes; passed to xr.apply_ufunc, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataArray with dimension <cite>dim</cite> reduced</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.pairwise_dists_pca">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">pairwise_dists_pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.pairwise_dists_pca" title="Link to this definition">Â¶</a></dt>
<dd><p>PCA-reduced pairwise interatomic distances</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â A DataArray containing the atomic positions;
must have a dimension called âatomâ</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A DataArray with the same dimensions as <cite>atXYZ</cite>, except for the âatomâ</p></li>
<li><p><em>dimension, which is replaced by a dimension âPCâ containing the principal</em></p></li>
<li><p><em>components (by default 2)</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.pca">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_pca_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.pca" title="Link to this definition">Â¶</a></dt>
<dd><p>xarray-oriented wrapper around scikit-learnâs PCA</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â A DataArray with at least a dimension with a name matching <cite>dim</cite></p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) â The name of the dimension to reduce</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) â The number of principle components to return, by default 2</p></li>
<li><p><strong>optional</strong> â The number of principle components to return, by default 2</p></li>
<li><p><strong>return_pca_object</strong> â Whether to return the scikit-learn <cite>PCA</cite> object as well as the
transformed data, by default False</p></li>
<li><p><strong>optional</strong> â Whether to return the scikit-learn <cite>PCA</cite> object as well as the
transformed data, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pca_res</em> â A DataArray with the same dimensions as <cite>da</cite>, except for the dimension
indicated by <cite>dim</cite>, which is replaced by a dimension <cite>PC</cite> of size <cite>n_components</cite></p></li>
<li><p><em>[pca_object]</em> â The trained PCA object produced by scikit-learn, if return_pca_object=True</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>, <em>PCA</em>] | <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.pca_and_hops">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">pca_and_hops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.pca_and_hops" title="Link to this definition">Â¶</a></dt>
<dd><p>Get PCA points and info on which of them represent hops</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>) â A Dataset containing âatXYZâ and âastateâ variables</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pca_res</em> â The PCA-reduced pairwise interatomic distances</p></li>
<li><p><em>hops_pca_coords</em> â <cite>pca_res</cite> filtered by hops, to facilitate marking hops when plotting</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>, <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.setup_frames">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">setup_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_to_eV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_e_kin_to_eV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativize_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativize_selector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.setup_frames" title="Link to this definition">Â¶</a></dt>
<dd><p>Performs several frequent setup tasks.
Each task can be skipped (by setting the corresponding parameter to False),
carried out if appropriate (None), or forced in the sense that an error is
thrown if the task is redundant (True).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.7.2)"><em>Dataset</em></a>) â The frames-like xr.Dataset to setup.</p></li>
<li><p><strong>to_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) â Whether to convert a âtsâ (timestep) coordinate to a âtimeâ coordinate, by default None</p></li>
<li><p><strong>optional</strong> â Whether to convert a âtsâ (timestep) coordinate to a âtimeâ coordinate, by default None</p></li>
<li><p><strong>convert_to_eV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) â Whether to convert the âenergyâ variable to eV, by default None</p></li>
<li><p><strong>optional</strong> â Whether to convert the âenergyâ variable to eV, by default None</p></li>
<li><p><strong>convert_e_kin_to_eV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) â Whether to convert the âe_kinâ (kinetic energy) variable to eV, by default None</p></li>
<li><p><strong>optional</strong> â Whether to convert the âe_kinâ (kinetic energy) variable to eV, by default None</p></li>
<li><p><strong>relativize_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>) â Whether to relativize energies, by default None</p></li>
<li><p><strong>optional</strong> â Whether to relativize energies, by default None</p></li>
<li><p><strong>relativize_selector</strong> â This argument is passed to relativize, by default None</p></li>
<li><p><strong>optional</strong> â This argument is passed to relativize, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A modified frames-like xr.Dataset</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> â If a task should be forced (i.e. the corresponding parameter is set to True)
    but cannot be carried out (e.g. because the dataset was already processed previously)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.subtract_combinations">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">subtract_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.subtract_combinations" title="Link to this definition">Â¶</a></dt>
<dd><p>Calculate all possible pairwise differences over a given dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>) â Input DataArray; must contain dimension <cite>dim</cite></p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Hashable" title="(in Python v3.13)"><em>Hashable</em></a>) â Dimension (of size $n$) to take pairwise differences over</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â If True, label the pairwise differences based on the index of <cite>dim</cite>, by default False</p></li>
<li><p><strong>optional</strong> â If True, label the pairwise differences based on the index of <cite>dim</cite>, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataArray with the dimension <cite>dim</cite> replaced by a dimension â<a href="#id1"><span class="problematic" id="id2">`</span></a>dim`combâ of size $n(n-1)/2$</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.sudi">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">sudi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.sudi" title="Link to this definition">Â¶</a></dt>
<dd><p>Successive differences</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>da</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.postprocess.trajs_with_hops">
<span class="sig-prename descclassname"><span class="pre">shnitsel.core.postprocess.</span></span><span class="sig-name descname"><span class="pre">trajs_with_hops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">astates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.postprocess.trajs_with_hops" title="Link to this definition">Â¶</a></dt>
<dd><p>Example usage: <cite>trajs_with_hops(frames[âastateâ])</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>astates</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.7.2)"><em>DataArray</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Hashable" title="(in Python v3.13)"><em>Hashable</em></a>]</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">shnitsel-tools</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="top-level.html">Top-level functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessors/ds_accessors.html">Dataset accessor methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessors/da_accessors.html">DataArray accessor methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="test-autosummary-accessors.html">Test autosummary-accessors</a></li>
<li class="toctree-l1"><a class="reference internal" href="priority.html">Functions to document first</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="top-level.html" title="next chapter">Top-level functions</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Theodor Everley RÃ¶hrkasten, Carolin MÃ¼ller.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>